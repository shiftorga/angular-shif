var angularShift;!function(){"use strict";angular.module("angularShift",["restangular","angularShift.shifts","angularShift.shiftEntries","angularShift.locations","angularShift.shiftTypes","angularShift.utils.notification","angularShift.utils.Confirmation","ui.router","toastr"]).config(function(t){t.setEncodeIds(!1),t.setBaseUrl("api")}).config(function(t,i){i.otherwise("/user_shifts/calendar")})}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(t){var i=function(){function t(t){this.$q=t}return t.prototype.confirm=function(t,i){var e={title:"Confirm",message:"Do you really want to continue?",buttons:{cancel:{label:"Cancel",className:"btn",callback:function(){return!1}},confirm:{label:"OK",className:"btn btn-primary",callback:i}}};return _.isObject(t)&&_.merge(e,t),this.$q(function(t){return e.callback=function(i){t(i)},bootbox.dialog(e)})},t}();t.ConfirmationService=i,i.$inject=["$q"],angular.module("angularShift.utils.Confirmation",[]).service("ConfirmationService",i)}(i=t.utils||(t.utils={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(t){var i=function(){function t(t){this.toastr=t,this.toastrConfig={tapToDismiss:!0,closeButton:!0,timeOut:5e3,extendedTimeOut:0,allowHtml:!0}}return t.prototype.success=function(t,i,e){void 0===e&&(e={}),this.showToastrMessage("success",t,i,e)},t.prototype.info=function(t,i,e){void 0===e&&(e={}),this.showToastrMessage("info",t,i,e)},t.prototype.error=function(t,i,e){void 0===e&&(e={}),this.showToastrMessage("error",t,i,e)},t.prototype.warning=function(t,i,e){void 0===e&&(e={}),this.showToastrMessage("warning",t,i,e)},t.prototype.showToastrMessage=function(t,i,e,n){void 0===n&&(n={}),n=n||{};var r=angular.extend(this.toastrConfig,n);if(!1===angular.isFunction(this.toastr[t]))throw t+" is not a toastr method";this.toastr[t](e,i,r)},t}();t.NotificationService=i,i.$inject=["toastr"];var e=angular.module("angularShift.utils.notification",[]);e.service("NotificationService",i)}(i=t.utils||(t.utils={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(){"use strict";angular.module("angularShift.locations",[]).config(function(t){t.state({name:"locations",url:"/locations","abstract":!0,views:{content:{templateUrl:"partials/shifts/shifts.html"}}}).state({name:"locations.edit",url:"/edit/{id:int}",views:{edit:{templateUrl:"partials/shifts/location_edit.html",controller:"LocationEditController",controllerAs:"locationEdit"}}})})}(i=t.locations||(t.locations={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(){}(i=t.locations||(t.locations={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(t){"use strict";var i=function(){function t(t){this.Resource=t.service("locations"),this.Restangular=t}return t.prototype.getAll=function(t){return void 0===t&&(t=[]),this.Resource.one().customGET("",t)},t.prototype.getById=function(t){return this.Resource.one(t).get()},t.prototype.remove=function(t){return this.Resource.one(t.RID).remove()},t.prototype.save=function(t){var i,e=t.RID;return i="undefined"==typeof e||null===e?this.Resource.post(t):this.Resource.getById(e).then(function(i){return _.assign(i,t),i.put()}),i.then(function(i){return _.assign(i,t),i})},t.$inject=["Restangular"],t}();t.LocationsService=i,angular.module("angularShift.locations").service("LocationsService",i)}(i=t.locations||(t.locations={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(){"use strict";angular.module("angularShift.shifts",["ui.calendar","ui.router"]).config(function(t){t.state({name:"shifts",url:"/user_shifts","abstract":!0,views:{content:{templateUrl:"partials/shifts/shifts.html"}}}).state({name:"shifts.calendar",url:"/calendar",views:{main:{templateUrl:"partials/shifts/calendar.html",controller:"ShiftsOnCalendarController",controllerAs:"shiftsOnCalendar"}}}).state({name:"shifts.show",url:"/show/{id}",views:{main:{templateUrl:"partials/shifts/show.html",controller:"ShiftsShowController",controllerAs:"shiftShow"}}}).state({name:"shifts.edit",url:"/edit/{id:int}",views:{edit:{templateUrl:"partials/shifts/edit.html",controller:"ShiftsEditController",controllerAs:"shiftEdit"}}})})}(i=t.shifts||(t.shifts={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(){"use strict";angular.module("angularShift.shiftEntries",[])}(i=t.shiftEntries||(t.shiftEntries={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(){}(i=t.shiftEntries||(t.shiftEntries={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(t){"use strict";var i=function(){function t(t){this.Resource=t.service("shift_entries"),this.Restangular=t}return t.prototype.getAll=function(t){return void 0===t&&(t=[]),this.Resource.one().customGET("",t)},t.prototype.getById=function(t){return this.Resource.one(t).get()},t.prototype.remove=function(t){return this.Resource.one(t.id).remove()},t.prototype.save=function(t){var i,e=t.id;return i="undefined"==typeof e||null===e?this.Resource.post(t):this.Resource.getById(e).then(function(i){return _.assign(i,t),i.put()}),i.then(function(i){return _.assign(i,t),i})},t.$inject=["Restangular"],t}();t.ShiftEntriesService=i,angular.module("angularShift.shifts").service("ShiftEntriesService",i)}(i=t.shiftEntries||(t.shiftEntries={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(){"use strict";angular.module("angularShift.shiftTypes",[]).config(function(t){t.state({name:"shiftType",url:"/shift_type","abstract":!0,views:{content:{templateUrl:"partials/shifts/shifts.html"}}}).state({name:"shiftType.edit",url:"/edit/{id:int}",views:{edit:{templateUrl:"partials/shifts/shift_type_edit.html",controller:"ShiftTypeEditController",controllerAs:"shiftTypeEdit"}}})})}(i=t.shiftTypes||(t.shiftTypes={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(t){var i=function(){function t(t,i,e){this.notificationService=t,this.$state=i,this.service=e,this.init()}return t.prototype.init=function(){var t=this,i=this.$state.params.id;this.notificationService.warning("WORK IN PROGRESS",'This feature isn`t implemented yet. Use <a href="/?p=user_shifts&edit_shift='+i+'">Link (edit shift type)</a> instead'),this.service.getById(i).then(function(i){t.shiftType=i,t.notificationService.success("SUCCESS","Successfully loaded resource "+i.name)},function(){t.notificationService.error("ERROR","Not able to fetch resource")})},t}();t.ShiftTypeEditController=i,i.$inject=["NotificationService","$state","ShiftTypesService"],angular.module("angularShift.shifts").controller("ShiftTypeEditController",i)}(i=t.shifts||(t.shifts={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(t){"use strict";var i=function(){function t(t){this.Resource=t.service("shift_types"),this.Restangular=t}return t.prototype.getAll=function(t){return void 0===t&&(t=[]),this.Resource.one().customGET("",t)},t.prototype.getById=function(t){return this.Resource.one(t).get()},t.prototype.remove=function(t){return this.Resource.one(t.id).remove()},t.prototype.save=function(t){var i,e=t.id;return i="undefined"==typeof e||null===e?this.Resource.post(t):this.Resource.getById(e).then(function(i){return _.assign(i,t),i.put()}),i.then(function(i){return _.assign(i,t),i})},t.$inject=["Restangular"],t}();t.ShiftTypesService=i,angular.module("angularShift.shiftTypes").service("ShiftTypesService",i)}(i=t.shiftTypes||(t.shiftTypes={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(t){"use strict";var i=function(){function t(t,i){this.Resource=t.service("shifts"),this.Restangular=t,this.shiftEntriesService=i}return t.prototype.getAll=function(t){return this.Resource.one().customGET("",t)},t.prototype.getById=function(t){return this.Resource.one(t).get()},t.prototype.remove=function(t){return this.Resource.one(t.sid).remove()},t.prototype.save=function(t){var i,e=t.sid;return i="undefined"==typeof e||null===e?this.Resource.post(t):this.Resource.getById(e).then(function(i){return _.assign(i,t),i.put()}),i.then(function(i){return _.assign(i,t),i})},t.prototype.getShiftEntries=function(){},t.$inject=["Restangular","ShiftEntriesService"],t}();t.ShiftsService=i,angular.module("angularShift.shifts").service("ShiftsService",i)}(i=t.shifts||(t.shifts={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(t){var i=function(){function t(){}return t.prototype.toEvent=function(t){var i=new Date;i.setTime(1e3*t.start);var e=new Date;return e.setTime(1e3*t.end),{title:_.isUndefined(t.title)?t.shiftType.name:t.title+"("+t.shiftType.name+")",start:i,end:e,shiftValues:t}},t}();t.ShiftEventConverter=i,angular.module("angularShift.shifts").service("ShiftsEventConverterService",i)}(i=t.shifts||(t.shifts={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(t){var i=function(){function t(t,i,e,n,r){var s=this;this.events=[],this.date=new Date,this.d=this.date.getDate(),this.m=this.date.getMonth(),this.y=this.date.getFullYear(),this.uiCalendarConfig=t,this.shiftsService=e,this.converter=n,this.eventSources=[],this.$state=r,i.uiConfig={calendar:{height:450,editable:!0,header:{left:"month agendaWeek agendaDay",center:"title",right:"today prev,next"},eventClick:function(t){s.$state.go("shifts.show",{id:t.shiftValues.sid})},eventDrop:i.alertOnDrop,eventResize:i.alertOnResize,viewRender:function(t){var i={start:t.start.get()._d.getTime()/1e3,end:t.end.get()._d.getTime()/1e3};return s.shiftsService.getAll(i).then(function(t){_.each(t,function(t){s.events.push(s.converter.toEvent(t))})}),!0}}},this.init()}return t.prototype.init=function(){this.eventSources=[this.events]},t}();t.ShiftsOnCalendarController=i,i.$inject=["uiCalendarConfig","$scope","ShiftsService","ShiftsEventConverterService","$state","LocationsService"],angular.module("angularShift.shifts").controller("ShiftsOnCalendarController",i)}(i=t.shifts||(t.shifts={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(t){var i=function(){function t(t,i,e){this.notificationService=t,this.$state=i,this.shiftsService=e,this.init()}return t.prototype.init=function(){var t=this,i=this.$state.params.id;this.notificationService.warning("WORK IN PROGRESS",'This feature isn`t implemented yet. Use <a href="/?p=user_shifts&edit_shift='+i+'">Link (edit shift)</a> instead'),this.shiftsService.getById(i).then(function(i){t.shift=i})},t}();t.ShiftsEditController=i,i.$inject=["NotificationService","$state","ShiftsService"],angular.module("angularShift.shifts").controller("ShiftsEditController",i)}(i=t.shifts||(t.shifts={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(t){var i=function(){function t(t,i,e,n){this.dateValues={dateStart:null,dateEnd:null,timeStart:null,timeEnd:null},this.shiftsService=i,this.$state=t,this.notificationService=e,this.confirmation=n,this.init()}return t.prototype.init=function(){var t=this,i=this.$state.params.id;this.shiftsService.getById(i).then(function(i){t.shift=i,t.dateValues={dateStart:moment(i.start,"X").format("YYYY-M-DD"),dateEnd:moment(i.end,"X").format("YYYY-M-DD"),timeStart:moment(i.start,"X").format("HH:mm"),timeEnd:moment(i.end,"X").format("HH:mm")}})},t.prototype.countShiftEntriesForAngelType=function(t,i){var e=0;return _.each(t.shiftEntries,function(t){t.angelType.id===i&&e++}),e},t.prototype.getPercentage=function(t,i){var e=t/i*100;return Math.round(e)},t.prototype.deleteShift=function(t){var i=this;this.confirmation.confirm({message:"Do you really want to delete the shift <b>"+this.buildLabel(t)+"</b>"},function(){i.shiftsService.remove(t).then(function(){i.$state.go("shift.calendar")},function(e){console.log(e),i.notificationService.error("Failed to delete ...","Errors while trying to delete shift <b>"+i.buildLabel(t)+"</b>")})})},t.prototype.buildLabel=function(t){var i=_.isUndefined(t.title)||""===t.title||null===t.title?null:t.title;return null===i?t.shiftType.name:i+" ("+t.shiftType.name+")"},t}();t.ShiftsShowController=i,i.$inject=["$state","ShiftsService","NotificationService","ConfirmationService"],angular.module("angularShift.shifts").controller("ShiftsShowController",i)}(i=t.shifts||(t.shifts={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(t){var i=function(){function t(t,i,e){this.notificationService=t,this.$state=i,this.service=e,this.init()}return t.prototype.init=function(){var t=this,i=this.$state.params.id;this.notificationService.warning("WORK IN PROGRESS",'This feature isn`t implemented yet. Use <a href="/?p=user_shifts&edit_shift='+i+'">Link (edit location)</a> instead'),this.service.getById(i).then(function(i){t.location=i,t.notificationService.success("SUCCESS","Successfully loaded resource "+i.Name)},function(){t.notificationService.error("ERROR","Not able to fetch resource")})},t}();t.LocationEditController=i,i.$inject=["NotificationService","$state","LocationsService"],angular.module("angularShift.shifts").controller("LocationEditController",i)}(i=t.locations||(t.locations={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(){"use strict";angular.module("angularShift.neededAngels",[])}(i=t.neededAngels||(t.neededAngels={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(t){var i=function(){function t(t,i){this.services={location:null},this.services.location=i,this.$scope=t,this.$scope.buttons=[],this.init()}return t.prototype.init=function(){var t=this;this.services.location.getAll().then(function(i){_.each(i,function(i){t.$scope.buttons.push({check:!0,label:i.Name})})})},t}();t.ListFilterController=i,i.$inject=["$scope","LocationsService"],angular.module("angularShift.shifts").controller("ListFilterController",i)}(i=t.shifts||(t.shifts={}))}(angularShift||(angularShift={}));var angularShift;!function(t){var i;!function(){angular.module("angularShift.shifts").directive("listFilter",function(){return{restrict:"E",templateUrl:"partials/shifts/list_filter.html",scope:{type:"@"},link:function(){},controller:"ListFilterController"}})}(i=t.shifts||(t.shifts={}))}(angularShift||(angularShift={}));